<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>{{ title }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Reuse Game24 CSS to keep identical layout/style -->
  <link rel="stylesheet" href="{{ url_for('games_assets_bp.static', filename='css/style.css') }}?v={{ session_id }}">
  <style nonce="{{ csp_nonce }}">
    .back-home { position:absolute; left:16px; top:12px; font-weight:600; text-decoration:none; }
  </style>
</head>
<body>
  <a class="back-home" href="{{ url_for('home.index') }}">← Home</a>

  <div class="wrap">
    <header class="game-header">
      <h1 class="game-title">{{ title }}</h1>
      <p class="game-subtitle">Start with A..K, then +2 +2 +2. Type the final number.</p>
    </header>

    <div class="panel">
      <div class="topline">
        <span id="question">Dealing…</span>
        <span id="timer">00:00.0</span>

        <div class="right-tools">
          <details class="settings">
            <summary>Settings</summary>

            <!-- Theme removed -->
            <div class="settings-row">
              <label>Difficulty
                <select id="level">
                  <option value="easy">easy</option>
                  <option value="medium">medium</option>
                  <option value="hard">hard</option>
		  {% if enable_all_mode %}
                  <option value="all"    {{ 'selected' if default_level=='all' else '' }}>all</option>
                  {% endif %}
                </select>
              </label>
              <label>
                <input type="checkbox" id="autoDeal" checked> Auto-Deal (Continuous Play)
              </label>
            </div>
          </details>

          <span class="link" id="howtoLink" title="How to play">?</span>
        </div>
      </div>

      <div class="board">
        <!-- Cards -->
        <div id="cards" class="cards"></div>

        <!-- 24 operators removed (not used for typing a final number) -->
        <!-- We keep the panel wrapper so spacing matches the stylesheet -->
        <div class="op-panel" style="display:none">
          <div class="ops-wrap" id="ops"></div>
        </div>

        <!-- Message -->
        <div id="msg" class="status"></div>

        <!-- Answer box -->
        <div class="answer-container">
          <input id="answer" class="answer-box" type="text"
                 placeholder="Type the final number, e.g., 7"
                 autocomplete="off" />
          <div id="answerFeedback" class="answer-feedback"></div>
        </div>

        <!-- Main actions -->
        <div class="button-row">
          <button id="backspace" class="danger-btn">⌫ Back</button>
          <button id="clear" class="clear-btn">Clear</button>
          <button id="check" class="success-btn">Check (Enter)</button>
          <button id="next" class="primary-btn">Deal (D)</button>
        </div>

        <!-- Secondary actions -->
        <div class="button-row">
          <button id="help" class="info-btn">Help (H)</button>
          <button id="restart" class="danger-btn">Restart(R)</button>
          <button id="exit" class="secondary-btn">Exit(X)</button>
        </div>

        <!-- Solutions -->
        <div id="solutionPanel"><div id="solutionMsg"></div></div>

        <!-- Stats -->
        <div class="stats">
          <span id="played">Played: 0</span>
          <span id="solved">Solved: 0</span>
          <span id="revealed">Revealed: 0</span>
          <span id="totalTime">Time: 00:00</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Inline config with CSP nonce -->
  <script nonce="{{ csp_nonce }}">
    window.GAME24_API_BASE = "{{ cb2_api_base }}";  // points at /count_by_2s/api
    // we send explicit image URLs from the server, so STATIC_BASE isn't used
    window.__FIRST_PAYLOAD__ = {{ first_payload|tojson }};
  </script>
  <!-- Reuse Game24 client (it will use GAME24_API_BASE and our FIRST_PAYLOAD) -->
  <script src="{{ url_for('count_by_2s.static', filename='js/script.js') }}?v={{ session_id }}"></script>
</body>
</html>

